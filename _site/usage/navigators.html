<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" media="screen"
          href="/assets/css/style.css?v=a40f7d1f40b0b80a960c57ea890a68c9b4568167">

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Navigators | Acorn</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Navigators" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Mastering Android navigation" />
<meta property="og:description" content="Mastering Android navigation" />
<link rel="canonical" href="http://localhost:4000/usage/navigators.html" />
<meta property="og:url" content="http://localhost:4000/usage/navigators.html" />
<meta property="og:site_name" content="Acorn" />
<script type="application/ld+json">
{"headline":"Navigators","@type":"WebPage","url":"http://localhost:4000/usage/navigators.html","description":"Mastering Android navigation","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>

<!-- HEADER -->
<div id="header_wrap" class="outer">
    <header class="inner">
        
        <a id="forkme_banner" href="http://github.com/nhaarman/acorn">View on GitHub</a>
        

        <h1 id="project_title">Acorn</h1>
        <h2 id="project_tagline">Mastering Android navigation</h2>

        
    </header>
</div>

<!-- MAIN CONTENT -->
<div id="main_content_wrap" class="outer">
    <section id="main_content" class="inner">
        
        <a href="http://localhost:4000">< Home</a>
        
        <h1 id="navigators">Navigators</h1>

<p><em>This page assumes you have knowledge of the responsibilities of a Navigator, as
described in <a href="../concepts/navigators/navigators">Concepts: Navigators</a>.</em></p>

<h2 id="the-navigator-interface">The <code class="highlighter-rouge">Navigator</code> interface</h2>

<p>Just as with Scenes, you can implement the <code class="highlighter-rouge">Navigator</code> interface to create your
own Navigator.
This time however, this is actually discouraged: it can be tricky to properly
deal with managing the different lifecycles.
There are a couple of excellent base classes available however that provide most
of the basic implementations you’ll need.
If you still need to implement your own <code class="highlighter-rouge">Navigator</code>, have a look at [[TODO]].</p>

<p>Like a Scene, the Navigator has a couple of lifecycle methods, and it provides
an interface <code class="highlighter-rouge">Events</code> to be able to notify interested parties of events.
As a user of one of the base classes mentioned above you usually won’t have to
override these methods, although you can hook into them when you need it.</p>

<ul>
  <li><code class="highlighter-rouge">onStart()</code>: Called when the Navigator is started;</li>
  <li><code class="highlighter-rouge">onStop()</code>: Called when the Navigator is stopped;</li>
  <li><code class="highlighter-rouge">onDestroy()</code>: Called when the Navigator gets destroyed;</li>
  <li><code class="highlighter-rouge">addNavigatorEventsListener(Navigator.Events)</code>: Allows interested parties to
register an events listener.</li>
</ul>

<h2 id="state-saving">State saving</h2>

<p>By default, a <code class="highlighter-rouge">Navigator</code> does not support state saving, although each of the
base implementations below do.
To support Navigator state saving, it can implement the <code class="highlighter-rouge">SavableNavigator</code>
interface.
In this method, the Navigator implementation must include everything necessary
to be able to reconstruct itself from a serialized state.
This includes the Navigator’s own internal state, but also that of its Scenes.
When using one of the base implementations this is done mostly for you, but you
can also choose to override the <code class="highlighter-rouge">saveInstanceState</code> method to include your own
data.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyNavigator</span><span class="p">(</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">userId</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span>
    <span class="n">savedState</span><span class="p">:</span> <span class="n">NavigatorState</span><span class="p">?</span>
<span class="p">)</span> <span class="p">:</span> <span class="n">SingleSceneNavigator</span><span class="p">(</span><span class="n">savedState</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">saveInstanceState</span><span class="p">()</span> <span class="p">:</span> <span class="n">NavigatorState</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">super</span><span class="p">.</span><span class="n">saveInstanceState</span><span class="p">().</span><span class="n">also</span> <span class="p">{</span>
            <span class="n">it</span><span class="p">[</span><span class="s">"user_id"</span><span class="p">]</span> <span class="p">=</span> <span class="n">userId</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>

        <span class="k">fun</span> <span class="nf">from</span><span class="p">(</span><span class="n">savedState</span><span class="p">:</span> <span class="n">NavigatorState</span><span class="p">)</span> <span class="p">:</span> <span class="n">MyNavigator</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">MyNavigator</span><span class="p">(</span>
                <span class="n">userId</span> <span class="p">=</span> <span class="n">savedState</span><span class="p">[</span><span class="s">"user_id"</span><span class="p">],</span>
                <span class="n">savedState</span> <span class="p">=</span> <span class="n">savedState</span>
            <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="base-implementations">Base implementations</h2>

<p>There are some base Navigator implementations to help you get started.
Each of these implementations implement <code class="highlighter-rouge">SavableNavigator</code> to allow their state
to be saved, and have their own strategies of doing this.</p>

<h3 id="singlescenenavigator1">SingleSceneNavigator<sup>1</sup></h3>

<p>The <code class="highlighter-rouge">SingleSceneNavigator</code> is a very basic Navigator that is only able to host
a single Scene during its lifetime, without ever navigating to a different Scene.
This class can sometimes come in handy when composing Navigators.</p>

<p>The SingleSceneNavigator provides a single abstract <code class="highlighter-rouge">createScene</code> method that
needs to be overridden, which provides the Scene to use in this Navigator.
If the Navigator is restored from a saved state and the Scene implements
<code class="highlighter-rouge">SavableScene</code>, the <code class="highlighter-rouge">createScene</code> method will be called with the instance that
was returned in <code class="highlighter-rouge">SavableScene#saveInstanceState</code>.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyHelloWorldNavigator</span><span class="p">(</span>
    <span class="n">savedState</span><span class="p">:</span> <span class="n">NavigatorState</span><span class="p">?</span>
<span class="p">)</span> <span class="p">:</span> <span class="n">SingleSceneNavigator</span><span class="p">(</span><span class="n">savedState</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">createScene</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">SceneState</span><span class="p">?)</span> <span class="p">:</span> <span class="n">Scene</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Container</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">HelloWorldScene</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The SingleSceneNavigator will automatically save its own and the Scene’s
instance state when necessary, and reconstruct itself from any saved state
passed to its constructor.</p>

<h3 id="replacingnavigator1">ReplacingNavigator<sup>1</sup></h3>

<p>The <code class="highlighter-rouge">ReplacingNavigator</code> is a Navigator that can switch between several
different Scenes, but has no back behavior.
When the user presses the back button, the Navigator will always directly finish
regardless of how many Scenes it has seen.</p>

<p>The ReplacingNavigator provides an abstract method <code class="highlighter-rouge">initialScene</code> that needs to
be overridden, which provides the initial Scene to use when not restored from a
saved state.
When the ReplacingNavigator is restored from a saved state, this method will not
be called.</p>

<p>Instead to support state restoration, this ReplacingNavigator provides an
abstract <code class="highlighter-rouge">instantiateScene</code> method which takes in a <code class="highlighter-rouge">KClass&lt;Scene&lt;*&gt;&gt;</code> and an
optional <code class="highlighter-rouge">SceneState</code> instance.
Since state saving can occur at any time, users of the ReplacingNavigator must
be able to handle all Scenes used in it, even if the Scene itself does not
implement <code class="highlighter-rouge">SavableScene</code>.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyNavigator</span><span class="p">(</span>
    <span class="n">savedState</span><span class="p">:</span> <span class="n">NavigatorState</span><span class="p">?</span>
<span class="p">)</span> <span class="p">:</span> <span class="n">ReplacingNavigator</span><span class="p">(</span><span class="n">savedState</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">initialScene</span><span class="p">()</span> <span class="p">:</span> <span class="n">Scene</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Container</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">MyFirstScene</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">onEvent</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">replace</span><span class="p">(</span><span class="n">MySecondScene</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">instantiateScene</span><span class="p">(</span>
        <span class="n">sceneClass</span><span class="p">:</span> <span class="n">KClass</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Scene</span><span class="p">&lt;*&gt;&gt;,</span>
        <span class="n">state</span><span class="p">:</span> <span class="n">SceneState</span><span class="p">?</span>
    <span class="p">)</span> <span class="p">:</span> <span class="n">Scene</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Container</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">when</span><span class="p">(</span><span class="n">sceneClass</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">MyFirstScene</span><span class="o">::</span><span class="kd">class</span> <span class="err">-&gt; </span><span class="nc">MyFirstScene</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">MySecondScene</span><span class="o">::</span><span class="kd">class</span> <span class="err">-&gt; </span><span class="nc">MySecondScene</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">-&gt;</span> <span class="n">error</span><span class="p">(</span><span class="s">"Unknown scene class: $sceneClass"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>To switch Scenes in the ReplacingNavigator, the class provides a <code class="highlighter-rouge">replace</code>
method.
When calling this method, the ReplacingNavigator will handle the previous and
new Scenes’ lifecycle methods appropriately and notify any listeners of the
change in scenery.</p>

<h3 id="stacknavigator1">StackNavigator<sup>1</sup></h3>

<p>The <code class="highlighter-rouge">StackNavigator</code> base class is the class you’ll feel most familiar with, as
it uses a stack to model its internal state.
You can push Scenes on the stack, pop them off, or replace the top Scene with
another one.
Pressing the back button will pop the top Scene off the stack.</p>

<p>The StackNavigator provides an abstract method <code class="highlighter-rouge">initialStack</code> that needs to
be overridden, which provides the initial Scene stack to use when not restored
from a saved state.
When the StackNavigator is restored from a saved state, this method will not
be called.</p>

<p>Instead to support state restoration, this StackNavigator provides an
abstract <code class="highlighter-rouge">instantiateScene</code> method which takes in a <code class="highlighter-rouge">KClass&lt;Scene&lt;*&gt;&gt;</code> and an
optional <code class="highlighter-rouge">SceneState</code> instance.
Since state saving can occur at any time, users of the StackNavigator must
be able to handle all Scenes used in it, even if the Scene itself does not
implement <code class="highlighter-rouge">SavableScene</code>.
The StackNavigator will take care of preserving the order of the stack.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyNavigator</span><span class="p">(</span>
    <span class="n">savedState</span><span class="p">:</span> <span class="n">NavigatorState</span><span class="p">?</span>
<span class="p">)</span> <span class="p">:</span> <span class="n">StackNavigator</span><span class="p">(</span><span class="n">savedState</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">initialStack</span><span class="p">()</span> <span class="p">:</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Scene</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Container</span><span class="p">&gt;&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">listOf</span><span class="p">(</span><span class="n">MyFirstScene</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">onEvent</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">push</span><span class="p">(</span><span class="n">MySecondScene</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">instantiateScene</span><span class="p">(</span>
        <span class="n">sceneClass</span><span class="p">:</span> <span class="n">KClass</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Scene</span><span class="p">&lt;*&gt;&gt;,</span>
        <span class="n">state</span><span class="p">:</span> <span class="n">SceneState</span><span class="p">?</span>
    <span class="p">)</span> <span class="p">:</span> <span class="n">Scene</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Container</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">when</span><span class="p">(</span><span class="n">sceneClass</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">MyFirstScene</span><span class="o">::</span><span class="kd">class</span> <span class="err">-&gt; </span><span class="nc">MyFirstScene</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">MySecondScene</span><span class="o">::</span><span class="kd">class</span> <span class="err">-&gt; </span><span class="nc">MySecondScene</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">-&gt;</span> <span class="n">error</span><span class="p">(</span><span class="s">"Unknown scene class: $sceneClass"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>To manipulate the stack in the StackNavigator, the class provides three methods:
<code class="highlighter-rouge">push</code>, <code class="highlighter-rouge">pop</code>, and <code class="highlighter-rouge">replace</code>.
When calling one of these methods, the StackNavigator will handle the Scenes’
lifecycle methods appropriately and will notify any listeners of the change in
scenery.</p>

<h2 id="composing-navigators">Composing Navigators</h2>

<p>One of the strengths of Navigators is that they can be composed into a
larger structure.
This allows for modular and reusable blocks in your application.
When composing Navigators, you have the same freedom as you have with regular
Navigators which means that you can choose your own internal model to represent
the state.</p>

<p>When composing Navigators, you usually create a Navigator that exclusively deals
with other Navigator instances directly, instead of mixing Scenes and Navigators
together.</p>

<p>The base implementations below show an overview of the default composite
Navigator classes.</p>

<h3 id="compositereplacingnavigator1">CompositeReplacingNavigator<sup>1</sup></h3>

<p>The <code class="highlighter-rouge">CompositeReplacingNavigator</code> class is the composite version of the
ReplacingNavigator, and can switch between several child navigators.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyCompositeNavigator</span><span class="p">(</span>
    <span class="n">savedState</span><span class="p">:</span> <span class="n">NavigatorState</span><span class="p">?</span>
<span class="p">)</span> <span class="p">:</span> <span class="n">CompositeReplacingNavigator</span><span class="p">(</span><span class="n">savedState</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">initialNavigator</span><span class="p">()</span> <span class="p">:</span> <span class="n">Navigator</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">MyFirstNavigator</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">onEvent</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">replace</span><span class="p">(</span><span class="n">MySecondNavigator</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">instantiateNavigator</span><span class="p">(</span>
        <span class="n">navigatorClass</span><span class="p">:</span> <span class="n">KClass</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Navigator</span><span class="p">&lt;*&gt;&gt;,</span>
        <span class="n">state</span><span class="p">:</span> <span class="n">NavigatorState</span><span class="p">?</span>
    <span class="p">)</span> <span class="p">:</span> <span class="n">Navigator</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Container</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">when</span><span class="p">(</span><span class="n">navigatorClass</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">MyFirstNavigator</span><span class="o">::</span><span class="kd">class</span> <span class="err">-&gt; </span><span class="nc">MyFirstNavigator</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">MySecondNavigator</span><span class="o">::</span><span class="kd">class</span> <span class="err">-&gt; </span><span class="nc">MySecondNavigator</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">-&gt;</span> <span class="n">error</span><span class="p">(</span><span class="s">"Unknown navigator class: $navigatorClass"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="compositestacknavigator1">CompositeStackNavigator<sup>1</sup></h3>

<p>The <code class="highlighter-rouge">CompositeStackNavigator</code> class is the composite version of the
StackNavigator, and uses a stack to model its internal state.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyCompositeNavigator</span><span class="p">(</span>
    <span class="n">savedState</span><span class="p">:</span> <span class="n">NavigatorState</span><span class="p">?</span>
<span class="p">)</span> <span class="p">:</span> <span class="n">CompositeStackNavigator</span><span class="p">(</span><span class="n">savedState</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">initialStack</span><span class="p">()</span> <span class="p">:</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Navigator</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">listOf</span><span class="p">(</span><span class="n">MyFirstNavigator</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">onEvent</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">push</span><span class="p">(</span><span class="n">MySecondNavigator</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">instantiateNavigator</span><span class="p">(</span>
        <span class="n">navigatorClass</span><span class="p">:</span> <span class="n">KClass</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Navigator</span><span class="p">&lt;*&gt;&gt;,</span>
        <span class="n">state</span><span class="p">:</span> <span class="n">NavigatorState</span><span class="p">?</span>
    <span class="p">)</span> <span class="p">:</span> <span class="n">Navigator</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">Container</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">when</span><span class="p">(</span><span class="n">navigatorClass</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">MyFirstNavigator</span><span class="o">::</span><span class="kd">class</span> <span class="err">-&gt; </span><span class="nc">MyFirstNavigator</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">MySecondNavigator</span><span class="o">::</span><span class="kd">class</span> <span class="err">-&gt; </span><span class="nc">MySecondNavigator</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">-&gt;</span> <span class="n">error</span><span class="p">(</span><span class="s">"Unknown navigator class: $navigatorClass"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<p>1: This class is available in the <code class="highlighter-rouge">ext-acorn</code> artifact.</p>

    </section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
    <footer class="inner">
        
        <p class="copyright">Acorn maintained by <a
                href="http://github.com/nhaarman">nhaarman</a></p>
        
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
    </footer>
</div>


</body>
</html>